/*
https://blog.csdn.net/sunmaoxiang/article/details/80959300#commentBox
我觉得这篇博客讲的通俗易懂，向量法很巧妙也很好理解
*/
//区间和悖论问题 HDU 3038
#include<iostream>
using namespace std;
const int maxn=200005;
int sum[maxn],pre[maxn];
int n,m;
void init()
{
    for(int i=0; i<=n; i++)
    {
        pre[i]=i;
        sum[i]=0;
    }
}
int find(int x)
{
    if(x==pre[x])
        return x;
    else
    {
        int root=find(pre[x]);
        sum[x]+=sum[pre[x]];
        return pre[x]=root;
    }
}
int main()
{

    while(cin>>n>>m)
    {
        init();
        int cnt=0;
        for(int i=0; i<m; i++)
        {
            int p,q,s;
            cin>>p>>q>>s;
            p--;
            int fp=find(p),fq=find(q);
            if(fp!=fq)
            {
                pre[fp]=fq;
                sum[fp]=sum[q]-sum[p]+s;
            }
            else if(sum[p]-sum[q]!=s)   cnt++;
        }
        cout<<cnt<<endl;
    }
    return 0;
}
//种类并查集(%2) POJ 2492
#include<iostream>
#include<cstdio>
using namespace std;
const int maxn=2005;
int pre[maxn],sum[maxn],n,k;
void init()
{
    for(int i=0; i<=n; i++)
    {
        pre[i]=i;
        sum[i]=0;
    }
}
int find(int x)
{
    if(x==pre[x])
        return x;
    else
    {
        int root=find(pre[x]);
        sum[x]=(sum[x]+sum[pre[x]])%2;
        return pre[x]=root;
    }
}
int main()
{
    int t,cas=0;
    cin>>t;
    while(t--)
    {
        scanf("%d%d",&n,&k);
        init();
        int x,y,flag=0;
        for(int i=0; i<k; i++)
        {
            scanf("%d%d",&x,&y);
            int fx=find(x),fy=find(y);
            if(fx!=fy)
            {
                pre[fx]=fy;
                sum[fx]=(sum[x]-sum[y]+1)%2;
            }
            else if(sum[x]==sum[y])
            {
                flag=1;
            }
        }
        printf("Scenario #%d:\n",++cas);
        if(flag)
        puts("Suspicious bugs found!\n");
        else
        puts("No suspicious bugs found!\n");
    }

    return 0;
}
//种类并查集(%3) POJ 1182
#include<cstdio>
#include<cstring>
#include<algorithm>
#include<iostream>
#include<string>
#include<vector>
#include<stack>
#include<bitset>
#include<cstdlib>
#include<cmath>
#include<set>
#include<list>
#include<deque>
#include<map>
#include<queue>
using namespace std;
#define inf 0x3f3f3f3f
#define ll long long
const int maxn=50005;
const double eps=1e-8;
const double PI = acos(-1.0);
ll gcd(ll a,ll b)
{
    return b==0?a:gcd(b,a%b);
}
int n,k,pre[maxn],r[maxn];
void init()
{
    for(int i=0;i<=n;i++)
    {
        pre[i]=i;
        r[i]=0;
    }
}
int find(int x)
{
    if(x==pre[x])
        return x;
    else
    {
        int root=find(pre[x]);
        r[x]=(r[x]+r[pre[x]])%3;
        return pre[x]=root;
    }
}
int main()
{
    scanf("%d%d",&n,&k);
    int d,x,y,ans=0;
    init();
    for(int i=0;i<k;i++)
    {
        scanf("%d%d%d",&d,&x,&y);
        int fx=find(x),fy=find(y);
        if(x>n||y>n||(d==2&&x==y))
            ans++;
        else if(fx!=fy)
        {
            pre[fx]=fy;
            r[fx]=(r[y]+d-1-r[x]+3)%3;
        }
        else if((r[x]-r[y]+3)%3!=d-1)
        {
            ans++;
        }
    }
    printf("%d\n",ans);
    return 0;
}